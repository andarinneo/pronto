% fs = 1000
% fs/2 = 500
% wo = 16/500

close all; clear all 
x =load('r_leg_kny_positions.txt');

mode =2;
if (mode ==0)
  wo = 16/(1000/2);
  [b,a] = butter(22,0.15,'low');
  fvtool(b,a);
elseif (mode ==1)
  % heavy low pass filter from vrc:
  b = [ -0.008103419153409,-0.000810618990958,-0.0007494115982237,-0.000611153923444,   ...
  -0.0003891449776452,-7.55205662672e-05,0.0003336647343425,0.0008466284776547, ...
   0.001464358952374, 0.002192444957178, 0.003029735989605, 0.003978601097679,  ...
     0.0050333725847, 0.006194244699355, 0.007453718804274, 0.008808875945055,  ...
    0.01024867727168,  0.01176740239529,  0.01333453044441,  0.01495437616932,  ...
    0.01661611333651,  0.01828347862038,  0.01995665559979,  0.02160848514311,  ...
    0.02322603146834,  0.02478735357424,  0.02627739990248,  0.02767530213939,  ...
    0.02896708267334,  0.03013524332251,  0.03116688716871,  0.03204636216309,  ...
    0.03276493696647,  0.03331108459848,  0.03367809550061,  0.03386660360657,  ...
    0.03386660360657,  0.03367809550061,  0.03331108459848,  0.03276493696647,  ...
    0.03204636216309,  0.03116688716871,  0.03013524332251,  0.02896708267334,  ...
    0.02767530213939,  0.02627739990248,  0.02478735357424,  0.02322603146834,  ...
    0.02160848514311,  0.01995665559979,  0.01828347862038,  0.01661611333651,  ...
    0.01495437616932,  0.01333453044441,  0.01176740239529,  0.01024867727168,  ...
   0.008808875945055, 0.007453718804274, 0.006194244699355,   0.0050333725847,  ...
   0.003978601097679, 0.003029735989605, 0.002192444957178, 0.001464358952374,  ...
  0.0008466284776547,0.0003336647343425,-7.55205662672e-05,-0.0003891449776452, ...
  -0.000611153923444,-0.0007494115982237,-0.000810618990958,-0.008103419153409]
  b = b./(sum(b));
  a=1;
else
  % lighter low pass filter from vrc
  b=[   0.005271208909706,  0.05204636786996,  0.05315761628452,  0.07562063364867, ...
    0.09406855250555,    0.108343855546,   0.1160610649931,   0.1160610649931, ...
      0.108343855546,  0.09406855250555,  0.07562063364867,  0.05315761628452, ...
    0.05204636786996, 0.005271208909706];
  sum(b)
  b = b./(sum(b));
  a=1;
end
  
y=filter(b,a,x);

figure
plot(x,'.')
hold on
plot(y,'r.')


% comparison spectrogram
figure
[S,F,T,P] = spectrogram(x , 256,255,256,1E3);
surf(T,F,10*log10(P),'edgecolor','none'); axis tight; 
view(0,90);
xlabel('Time (Seconds) original'); ylabel('Hz');

figure
[S,F,T,P] = spectrogram(y , 256,255,256,1E3);
surf(T,F,10*log10(P),'edgecolor','none'); axis tight; 
view(0,90);
xlabel('Time (Seconds) - low pass'); ylabel('Hz');